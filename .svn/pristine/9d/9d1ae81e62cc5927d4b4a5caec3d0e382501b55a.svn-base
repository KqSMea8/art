<extend name="Public:base" />
<style type="text/css" rel="stylesheet">
    div.row {
        margin-bottom: 20px;
        margin-top: 20px;
    }
</style>
<block name="content">
    <div class="row">
        <div class="col-lg-12">
            <div class="panel panel-default">
                <div class="panel-heading">
                    动态详情如下：
                </div>
                <!-- /.panel-heading -->
                <div class="panel-body">
                    <div class="row">
                        <div class="col-md-1">标题</div>
                        <div class="col-md-10">{$data['title']}</div>
                    </div>
                    <div style="height:3px;border-bottom: 1px solid #ccc"></div>
                    <div class="row">
                        <div class="col-md-1">内容</div>
                        <div class="col-md-4">{$data['wit']|htmlspecialchars_decode}</div>
                    </div>
                    <div style="height:3px;border-bottom: 1px solid #ccc"></div>
                    <div class="row">
                        <div class="col-md-1">创建时间</div>
                        <div class="col-md-10">{$data['create_time']|date="Y-m-d H:i:s",###}</div>
                    </div>
                    <div style="height:3px;border-bottom: 1px solid #ccc"></div>
                    <div class="form-group">
                        <input type="hidden" name="id" value="{$data['id']}">
                    </div>
                </div>
                <!-- /.panel-body -->
            </div>
            <a href="#" class="btn btn-success" id="recommend" onclick="return recommend(<?php echo $data['id']; ?>,this)">推荐</a>
            <a href="#" class="btn btn-success" id="cancelRecommend" onclick="return delete_comment(<?php echo $data['id']; ?>,this)">取消推荐</a>
            <a href="{:U('RecommendRecord/index')}" class="btn btn-default">返回</a>
            <!-- /.panel -->
        <!-- /.col-lg-12 -->
    </div>
</block>
<block name="customJs">
    <script>
        $(document).ready(function(){
            var type = <?php echo $data['is_recommend']?>;
            if(type == 1){
                $("#cancelRecommend").show();
                $("#recommend").hide();
            }else{
                $("#recommend").show();
                $("#cancelRecommend").hide();
            }
        });

        function recommend(id, obj) {
            $.prompt("确定推荐该艺术家？", {
                title: "提示",
                buttons: {"确定": true, "取消": false},
                submit: function (e, v, m, f) {
                    if (v == true) {
                        $(obj).after("<img id='loading" + id + "' src='/Public/Admin/image/loading.gif' /> ");
                        $.ajax({
                            type: 'post',
                            url: '<?php echo U('Admin/RecommendRecord/recommend');?>',
                            data: "id=" + id,
                            cache: false,
                            dataType: 'json',
                            error: function (data) {
                                $.prompt("<span style=\" color:#F00\">error</span>", {
                                    title: "提示",
                                    buttons: {"确定": false}
                                });
                            },
                            success: function (data) {
                                if (data.error == 0) {
                                    $.prompt("修改成功！", {
                                        title: "提示",
                                        buttons: {"确定": true},
                                        submit: function (e, v, m, f) {
                                            if (v == true) {
                                                window.location.href="{:U('RecommendRecord/index')}";
                                            }
                                        }
                                    });

                                }else{
                                    $.prompt("<span style=\" color:#F00\">"+data.message+"</span>", {
                                        title: "提示",
                                        buttons: {"确定": false}
                                    });
                                }

                            }
                        });
                    }else{

                    }
                }
            });
            return false;
        }

        function delete_comment(id, obj) {
            $.prompt("确定取消推荐该艺术家？", {
                title: "提示",
                buttons: {"确定": true, "取消": false},
                submit: function (e, v, m, f) {
                    if (v == true) {
                        $(obj).after("<img id='loading" + id + "' src='/Public/Admin/image/loading.gif' /> ");
                        $.ajax({
                            type: 'post',
                            url: '<?php echo U('Admin/RecommendRecord/cancelRecommend');?>',
                            data: "id=" + id,
                            cache: false,
                            dataType: 'json',
                            error: function (data) {
                                $.prompt("<span style=\" color:#F00\">error</span>", {
                                    title: "提示",
                                    buttons: {"确定": false}
                                });
                            },
                            success: function (data) {
                                if (data.error == 0) {
                                    $.prompt("修改成功！", {
                                        title: "提示",
                                        buttons: {"确定": true},
                                        submit: function (e, v, m, f) {
                                            if (v == true) {
                                                window.location.href="{:U('RecommendRecord/index')}";
                                            }
                                        }
                                    });

                                }else{
                                    $.prompt("<span style=\" color:#F00\">"+data.message+"</span>", {
                                        title: "提示",
                                        buttons: {"确定": false}
                                    });
                                }

                            }
                        });
                    }else{

                    }
                }
            });
            return false;
        }

    </script>
</block>