<extend name="Public:base" />
<block name="content">
<form ></form>
    <div class="row">
        <div class="col-lg-12">
            <div class="panel panel-default">
                    <div class="panel-heading">
                                  <a href="art_subject?id={$art['id']}">画作详情</a>
                </div>
                <!-- /.panel-heading -->
                <div class="panel-body">
                  <form class="" action="{:U(Subject/add_pro)}" method="post" enctype="multipart/form-data" >
                    <div class="row">
                        <div class="col-md-2">艺术家</div>
                        <div class="col-md-10">
                          <input type="text" name="name" value="{$data[0]['artist']}">
                        </div>
                    </div><br>
                    <div class="row">
                        <div class="col-md-2">画作名</div>
                        <div class="col-md-10">
                          <input type="text" name="name" value="{$data[0]['name']}">
                        </div>
                    </div><br>
                     <div class="row">
                        <div class="col-md-2">故事</div>
                        <div class="col-md-10">
                          <input type="text" name="name" value="{$data[0]['story']}">
                        </div>
                    </div><br>
                    <div class="row">
                        <div class="col-md-2">创建时间</div>
                        <div class="col-md-10">
                          <input type="text" name="name" value="{$data[0]['create_time']}">
                        </div>
                    </div><br>
                    
            </form>
                </div>
                <!-- /.panel-body -->
            </div>
            <!-- /.panel -->
        </div>
        <!-- /.col-lg-12 -->
    </div>
</block>
<block name="customJs">
  <script type="text/javascript" src="/Public/Admin/js/html2canvas.min.js"></script>
  <script type="text/javascript">
  var one = '';
  var two = '';
  var three = '';
  $(function(){
    html2canvas(document.getElementById('wrap1')).then(function(canvas) {var url = canvas.toDataURL(); //以下代码为下载此图片功能
      one = transDataUrl(url);
    });
    html2canvas(document.getElementById('wrap2')).then(function(canvas) {var url = canvas.toDataURL(); //以下代码为下载此图片功能
      two = transDataUrl(url);
    });
    html2canvas(document.getElementById('wrap3')).then(function(canvas) {var url = canvas.toDataURL(); //以下代码为下载此图片功能
      three = transDataUrl(url);
    });
  });
  function transDataUrl(dataurl){
    var data = dataurl.split(',')[1];
    data = window.atob(data);
    var ia = new Uint8Array(data.length);
    for (var i = 0; i < data.length; i++) {
        ia[i] = data.charCodeAt(i);
    }
    return new Blob([ia],{type:"image/png",endings:'transparent'});
  }
  function upload(){
    var fd=new FormData();
    fd.append('one',one);
    fd.append('two',two);
    fd.append('three',three);
    fd.append('artist',"{$info['artist']}");
    $.ajax({
       url : "{:U('Extension/upload')}",
       data : fd,
       type : 'POST',
       dataType : 'json',
       asyn : false,
       processData: false,  // 告诉jQuery不要去处理发送的数据
       contentType: false,   // 告诉jQuery不要去设置Content-Type请求头
       success : function(data){
         $('#one').val(data.one);
         $('#two').val(data.two);
         $('#three').val(data.three);
         alert('上传成功');
       }
    });
    return true;
  }
  </script>
</block>



