<!--<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <title></title>
    <!-- Bootstrap Core CSS -->
    <link href="/Public/Admin/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- MetisMenu CSS -->
    <link href="/Public/Admin/vendor/metisMenu/metisMenu.min.css" rel="stylesheet">

    <link href="/Public/Admin/vendor/Magnific-Popup/magnific-popup.css" rel="stylesheet">
    <link href="/Public/Admin/vendor/bootstrap-datetimepicker/bootstrap-datetimepicker.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="/Public/Admin/dist/css/sb-admin-2.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="/Public/Admin/vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->
    <style type="text/css">
        body {
            margin-left: 8px;
            margin-top: 0px;
            margin-right: 8px;
            margin-bottom: 0px;
            font-size: 13px;
            line-height: 25px;
        }

        td {
            padding: 3px;
        }
    </style>
    <script src="/Public/Admin/vendor/jquery/jquery.min.js"></script>
    <link href="/Public/Admin/js/jquery-impromptu/jquery-impromptu.css" rel="stylesheet">
</head>

<body>
<form id="post_from" name="post_from" method="post" action="{:U('ArtworkPrints/printsListEdit')}"
      onsubmit="return check_form();">
    <table width="741" border="1" align="center" cellpadding="0" cellspacing="0"
           class="table table-striped table-bordered table-hover">
        <?php
        if ($artwork_prints_list_info['shape'] == 1) {
            $shape_t = '方形';
            $size_t = $artwork_prints_list_info['length'] . '×' . $artwork_prints_list_info['width'];
        } elseif ($artwork_prints_list_info['shape'] == 2) {
            $shape_t = '圆形';
            $size_t = '直径:' . $artwork_prints_list_info['diameter'];
        }
        ?>
        <tr>
            <td colspan="2" style="text-align:center; color:#00F; font-size:16px; font-weight:bold;">&nbsp;</td>
        </tr>
        <tr>
            <td width="75">编号</td>
            <td width="75"><?php echo $artwork_prints_list_info['serial_number']; ?></td>
        </tr>
        <tr>
            <td>画作名称</td>
            <td><?php echo htmlspecialchars($artwork_prints_list_info['art_name']); ?></td>
        </tr>
        <tr>
            <td>艺术家</td>
            <td><?php echo $artwork_prints_list_info['artist_name']; ?></td>
        </tr>
        <tr>
            <td>第N幅</td>
            <td><?php echo $artwork_prints_list_info['prints_number']; ?></td>
        </tr>
        <tr>
            <td>形状</td>
            <td><?php echo $shape_t; ?></td>
        </tr>
        <tr>
            <td>尺寸</td>
            <td><?php echo $size_t; ?></td>
        </tr>
        <tr>
            <td>销售状态</td>
            <td><select name="is_sold" id="is_sold">
                    <option value="0" <?php if ($artwork_prints_list_info['is_sold'] == 0) echo 'selected="selected"'; ?>>
                        未销售
                    </option>
                    <option value="1" <?php if ($artwork_prints_list_info['is_sold'] == 1) echo 'selected="selected"'; ?>>
                        已销售
                    </option>
                </select></td>
        </tr>
        <tr>
            <td>购买人</td>
            <td><input name="buyer" type="text" id="buyer" value="<?php echo $artwork_prints_list_info['buyer']; ?>"/>
            </td>
        </tr>
        <tr>
            <td>购买人手机号码</td>
            <td><input name="buyer_mobile" type="text" id="buyer_mobile" value="<?php echo $artwork_prints_list_info['buyer_mobile']; ?>" maxlength="11" onchange="checkPhone(this.value)"/>
            </td>
        </tr>
        <tr>
            <td>购买时间</td>
            <td><input name="buy_time" type="date" id="buy_time" min="2017-01-01" max="{:date('Y-m-d')}"
                       value="<?php if ($artwork_prints_list_info['buy_time']) echo date('Y-m-d', $artwork_prints_list_info['buy_time']); ?>"/>
            </td>
        </tr>
        <tr>
            <td>价格</td>
            <td><input name="price" type="text" id="price" value="<?php echo $artwork_prints_list_info['price']; ?>"/>
            </td>
        </tr>
        <tr>
            <td>&nbsp;</td>
            <td>
                <div id="ajax_loading"></div>
            </td>
        </tr>
        <tr>
            <td>&nbsp;</td>
            <td><input type="submit" name="button" id="button" value="保存"/>
                <input name="id" type="hidden" id="id" value="<?php echo $artwork_prints_list_info['id']; ?>"/></td>
        </tr>
        <?php
        foreach ($artwork_prints_list as $key => $artwork_prints_list_info) {
            if ($artwork_prints_list_info['shape'] == 1) {
                $shape_t = '方形';
                $size_t = $artwork_prints_list_info['length'] . '×' . $artwork_prints_list_info['width'];
            } elseif ($artwork_prints_list_info['shape'] == 2) {
                $shape_t = '圆形';
                $size_t = '直径:' . $artwork_prints_list_info['diameter'];
            }


            ?>
        <?php } ?>
    </table>
</form>
</body>
</html>
<script src="/Public/Admin/vendor/bootstrap-datetimepicker/bootstrap-datetimepicker.js"></script>
<script src="/Public/Admin/vendor/bootstrap-datetimepicker/bootstrap-datetimepicker.zh-CN.js"></script>

<script language="javascript" type="text/javascript"
        src="/Public/Admin/js/jquery-impromptu/jquery-impromptu.js"></script>

<script>
    $(document).ready(function () {

        /*$('#buy_time').datetimepicker({
            format: 'yyyy-mm-dd',
            language: 'zh-CN',
            weekStart: 1,
            todayBtn: 1,
            autoclose: 1,
            todayHighlight: 1,
            startView: 2,
            minView: 2,
            forceParse: 0
        });
*/

    });
</script>

<script type="text/javascript">
    function checkPhone(value){
        if(value!=""){
            var re = /^1\d{10}$/
            if (re.test(value)) {

            } else {
                $.prompt("<span style=\" color:#AD6C14\">手机号格式错误!</span>", {
                    title: "提示",
                    buttons: {"确定": false}
                });
            }
        }
    }
    function check_form() {
        var is_sold = $("#is_sold").val();
        var buyer = $("#buyer").val();
        var buy_time = $("#buy_time").val();
        var price = $("#price").val();
        var buyer_mobile = $("#buyer_mobile").val();
        var check = true;
        var message = "";
        if (is_sold == 1) {
            if ($.trim(buyer) == '') {
                check = false;
                message = message + "<li>购买人不能为空</li>";
            }
            if ($.trim(buy_time) == '') {
                check = false;
                message = message + "<li>购买时间不能为空</li>";
            }

            if (isNaN(price) || price <= 0) {
                check = false;
                message = message + "<li>请输入价格</li>";
            }

            if ($.trim(buyer_mobile) != '') {
                var re = /^1\d{10}$/
                if (re.test(buyer_mobile)) {

                } else {
                    check = false;
                }
                message = message + "<li>手机号格式错误!</li>";
            }
        }

        if (check == false) {
            $.prompt("<span style=\" color:#AD6C14\">" + message + "</span>", {
                title: "提示",
                buttons: {"确定": false}
            });
            return false;
        } else {

            $("#ajax_loading").html("<img id='loading_select' src='/Public/Admin/image/loading.gif' /> ");
            $.ajax({
                type: 'post',
                url: '<?php echo U('ArtworkPrints/printsListEdit');?>',
                data: $("#post_from").serialize(),
                cache: false,
                dataType: 'json',
                error: function (data) {

                    alert("error2");
                },
                success: function (data) {
                    $("#ajax_loading").html("");
                    //alert(data);
                    if (data.error == 0) {


                        $.prompt("保存成功！", {
                            title: "提示",
                            buttons: {"确定": true},
                            submit: function (e, v, m, f) {

                                if (v == true) {
                                    self.parent.tb_remove();
                                    self.parent.location.reload();
                                }
                            }
                        });

                    } else {

                        $.prompt("<span style=\" color:#F00\">" + data.message + "</span>", {
                            title: "提示",
                            buttons: {"确定": false}
                        });
                    }

                }
            });


        }

        return false;
    }
</script>