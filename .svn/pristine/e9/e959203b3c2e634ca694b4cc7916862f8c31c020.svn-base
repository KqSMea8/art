<extend name="Public:base" />
<block name="content">
    <style type="text/css">
        td{
            padding: 5px 0px;
            margin: 0px;
        }
        label{
            min-width: 60px;
            display:inline-block;
        }

    </style>
    <div class="row" style="min-width: 1400px;">
        <div class="col-lg-12">
            <div class="panel panel-default">
              <div class="panel-heading">
                话题管理
              </div>
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-lg-12">
                            <form action="{:U('Topic/topic')}" class="form-inline" onsubmit="return checkForm();">
                                <table width="1300px">
                                    <tr>
                                        <td colspan="2">
                                            <div style="width: 300px" class="form-group">
                                                <label for="">话题标题</label>
                                                <input style="width: 180px;display:inline-block;" type="text" name="title" class="form-control" value="{:I('title')}">
                                            </div>
                                        </td>
                                        <td colspan="2">
                                            <div style="width: 300px" class="form-group">
                                                <label for="">浏览数</label>
                                                <input style="width: 100px;display:inline-block;" type="number" id="sViewTotal" name="sViewTotal" class="form-control number" value="{:I('sViewTotal')}" min="0">
                                                --
                                                <input style="width: 100px;display:inline-block;" type="number" id="eViewTotal" name="eViewTotal" class="form-control number" value="{:I('eViewTotal')}" min="0">
                                            </div>
                                        </td>
                                        <td colspan="2">
                                            <div style="width: 300px" class="form-group">
                                                <label for="">关注数</label>
                                                <input style="width: 100px;display:inline-block;" type="number" id="sFollowTotal" name="sFollowTotal" class="form-control number" value="{:I('sFollowTotal')}" min="0">
                                                --
                                                <input style="width: 100px;display:inline-block;" type="number" id="eFollowTotal" name="eFollowTotal" class="form-control number" value="{:I('eFollowTotal')}" min="0">
                                            </div>
                                        </td>
                                        <td colspan="2">
                                            <div style="width: 300px" class="form-group">
                                                <label for="">讨论数</label>
                                                <input style="width: 100px;display:inline-block;" type="number" id="sDiscussTotal" name="sDiscussTotal" class="form-control number" value="{:I('sDiscussTotal')}" min="0">
                                                --
                                                <input style="width: 100px;display:inline-block;" type="number" id="eDiscussTotal" name="eDiscussTotal" class="form-control number" value="{:I('eDiscussTotal')}" min="0">
                                            </div>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td colspan="2">
                                            <div style="width: 300px" class="form-group">
                                                <label for="">转发数</label>
                                                <input style="width: 100px;display:inline-block;" type="number" id="sShareTotal" name="sShareTotal" class="form-control number" value="{:I('sShareTotal')}" min="0">
                                                --
                                                <input style="width: 100px;display:inline-block;" type="number" id="eShareTotal" name="eShareTotal" class="form-control number" value="{:I('eShareTotal')}" min="0">
                                            </div>
                                        </td>
                                        <td colspan="3">
                                            <div style="width: 450px" class="form-group">
                                                <label for="">创建时间</label>
                                                <input style="width: 180px;display:inline-block;" type="date" id="sCreateTime" name="sCreateTime" class="form-control" value="{:I('sCreateTime')}" min="2017-01-01" max="{:date('Y-m-d')}">
                                                --
                                                <input style="width: 180px;display:inline-block;" type="date" id="eCreateTime" name="eCreateTime" class="form-control" value="{:I('eCreateTime')}" min="2017-01-01" max="{:date('Y-m-d')}">
                                            </div>
                                        </td>
                                        <td style="padding: 0 10px">
                                            <button class="btn btn-default form-control" type="submit">查看</button>
                                        </td>
                                        <td></td>
                                        <td></td>
                                    </tr>
                                </table>

                            </form>
                        </div><!-- /.col-lg-6 -->
                    </div><!-- /.row -->
                </div>
                <!-- /.panel-heading -->
                <div class="panel-body">
                    <table width="100%" class="table table-striped table-bordered table-hover" >
                        <thead>
                        <tr>
                            <th>话题标题</th>
                            <th>话题背景</th>
                            <th>用户昵称</th>
                            <th>用户头像</th>
                            <th>创建时间</th>
                            <th>浏览数</th>
                            <th>关注数</th>
                            <th>讨论数</th>
                            <th>转发数</th>
                            <th>操作</th>
                        </tr>
                        </thead>
                        <tbody>
                        <foreach name="list" item="item" key="k" >
                            <tr style="height: 120px;">
                                <td style="max-width: 80px;word-wrap:break-word">{$item['title']}</td>
                                <td style="max-width: 80px;word-wrap:break-word">{$item['content']}</td>
                                <td style="max-width: 80px;word-wrap:break-word">{$item['nickname']}</td>
                                <td>
                                    <if condition="$item['face'] == '' ">
                                        <else />
                                        <img src="{$item['face']}" alt="" style="width:100px;height: 100px;">
                                    </if>
                                </td>
                                <td>{$item['create_time']}</td>
                                <td>{$item['view_num']}</td>
                                <td>{$item['follow_num']}</td>
                                <td>{$item['discuss_num']}</td>
                                <td>{$item['share_num']}</td>
                                <td>
                                  <a href="{$url}/discussion/discussionList/{$item['id']}" target="_blank">点击查看详情</a>
                                </td>
                            </tr>
                        </foreach>
                        </tbody>
                    </table>
                    <!-- /.table-responsive -->
                    <!-- TODO:page -->
                    {$nav}
                </div>
                <!-- /.panel-body -->
            </div>
            <!-- /.panel -->
        </div>
        <!-- /.col-lg-12 -->
    </div>
</block>
<block name="customJs">
    <script>
        $(document).ready(function(){
            /* $('#az-id-date-selector').datetimepicker({
             format:'yyyy-mm-dd',
             language:  'zh-CN',
             weekStart: 1,
             todayBtn:  1,
             autoclose: 1,
             todayHighlight: 1,
             startView: 2,
             minView: 2,
             forceParse: 0
             })*/

            $('.number').bind('input propertychange', function() {
                var re = /^0+$/;
                var re1 = /^[0-9]/;
                if (re.test($(this).val()) || $(this).val()<0 || !re1.test($(this).val())) {
                    $(this).val('0');
                }
            });


        });


        function checkForm(){
            var sCreateTime = $("#sCreateTime").val();
            var eCreateTime = $("#eCreateTime").val();
            var sShareTotal = $("#sShareTotal").val();
            var eShareTotal = $("#eShareTotal").val();
            var sViewTotal = $("#sViewTotal").val();
            var eViewTotal = $("#eViewTotal").val();
            var sDiscussTotal = $("#sDiscussTotal").val();
            var eDiscussTotal = $("#eDiscussTotal").val();
            var sFollowTotal = $("#sFollowTotal").val();
            var eFollowTotal = $("#eFollowTotal").val();
            var check = true;
            var message = "";

            if(sCreateTime!='' && eCreateTime!='' && sCreateTime>eCreateTime){
                var check = false;
                message = message + "<li>开始创建时间不能晚于结束创建时间!</li>";
            }


            if(sShareTotal!='' && eShareTotal!='' && eShareTotal>0 && sShareTotal-eShareTotal>0){
                var check = false;
                message = message + "<li>开始浏览数不能大于结束浏览数!</li>";
            }
            if(sViewTotal!='' && eViewTotal!='' && eViewTotal>0 && sViewTotal-eViewTotal>0){
                var check = false;
                message = message + "<li>开始浏览数不能大于结束浏览数!</li>";
            }
            if(sDiscussTotal!='' && eDiscussTotal!='' && eDiscussTotal>0 && sDiscussTotal-eDiscussTotal>0){
                var check = false;
                message = message + "<li>开始喜欢数不能大于结束喜欢数!</li>";
            }
            if(sFollowTotal!='' && eFollowTotal!='' && eFollowTotal>0 && sFollowTotal-eFollowTotal>0){
                var check = false;
                message = message + "<li>开始评论数不能大于结束评论数!</li>";
            }

            if (check == false) {
                $.prompt("<span style=\" color:#AD6C14\">"+message+"</span>", {
                    title: "提示",
                    buttons: {"确定": false}
                });
                return false;
            } else {
                return true;
            }

        }

    </script>
</block>
