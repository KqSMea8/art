<extend name="Public:base" />
<block name="content">
    <div class="row">
        <div class="col-lg-12">
            <div class="panel panel-default">
              <div class="panel-heading">
                艺术专题列表
              </div>
                <div class="panel-heading">
                    <div class="row">
                        <div class="col-lg-12">
                            <form action="{:U('Subject/index')}" class="form-inline" onsubmit="return checkForm();">
                                <div class="form-group">
                                  <label for="">开始时间</label>
                                  <input type="date" id="start_time" name="start_time" class="form-control" value="{:I('start_time')}" min="2017-01-01" max="{:date('Y-m-d')}">
                                </div>
                                <div class="form-group">
                                    <label for="">结束时间</label>
                                    <input type="date" id="end_time" name="end_time" class="form-control" value="{:I('end_time')}" min="2017-01-01" max="{:date('Y-m-d')}">
                                </div>
                                <div class="form-group">
                                    <label for="">专题名称</label>
                                    <input type="text" name="sub_name" class="form-control" value="{:I('sub_name')}">
                                </div>
                                <div class="form-group">
                                    <label for="">专题简述</label>
                                    <input type="text" name="sub_title" class="form-control" value="{:I('sub_title')}">
                                </div>
                                <button class="btn btn-default form-control" type="submit">查看</button>
                            </form>
                        </div><!-- /.col-lg-6 -->
                    </div><!-- /.row -->
                </div>
                <!-- /.panel-heading -->
                <div class="panel-body">
                    <table width="100%" class="table table-striped table-bordered table-hover" >
                        <thead>
                        <tr>
                            <th>序号</th>
                            <th>专题名称</th>
                            <th>专题简述</th>
                            <th>开始时间</th>
                            <th>结束时间</th>
                            <th>浏览次数</th>
                            <th>状态</th>
                            <th>操作</th>
                        </tr>
                        </thead>
                        <tbody>
                        <foreach name="lists" item="art" key="k" >
                            <tr>
                                <td>{$art['id']}</td>
                                <td>{$art['sub_name']}</td>
                                <td>{$art['sub_title']}</td>
                                <td>{$art['start_time']|date='Y-m-d',###}</td>
                                <td>{$art['end_time']|date='Y-m-d',###}</td>
                                <td>{$art['view_num']}</td>
                                <td>
                                    <if condition="$art['status'] eq 0">
                                        已上线
                                        <else />
                                        已下线
                                    </if>
                                    <?php
									$thistime=time();
                                    if($art['start_time']>$thistime){
										echo '<span style=" color:#06C">开始时间未到</span>';
										}elseif($art['end_time']<$thistime){
												echo '<span style=" color:#F00">结束时间到了</span>';
											}
									?>
                                </td>
                                <td>
                                  <a href="{:U('Admin/Subject/getApplyDetail',['subid'=>$art['id']])}">查看详情</a>||
                                  <a href="{:U('Admin/Subject/editSubject',['subid'=>$art['id']])}">编辑专题</a>
                                </td>
                            </tr>
                         </foreach> 
                        </tbody>
                    </table>
                    <!-- /.table-responsive -->
                    <!-- TODO:page -->
                    {$nav}
                </div>
                <!-- /.panel-body -->
            </div>
            <!-- /.panel -->
        </div>
        <!-- /.col-lg-12 -->
    </div>
</block>
<block name="customJs">
    <script>
        // $(document).ready(function(){
        //     $('#az-id-date-selector').datetimepicker({
        //         format:'yyyy-mm-dd',
        //         language:  'zh-CN',
        //         weekStart: 1,
        //         todayBtn:  1,
        //         autoclose: 1,
        //         todayHighlight: 1,
        //         startView: 2,
        //         minView: 2,
        //         forceParse: 0
        //     })
        // });


        function checkForm(){
            var start_time = $("#start_time").val();
            var end_time = $("#end_time").val();
            var check = true;
            var message = "";
            if(start_time!='' && end_time!='' && start_time>end_time){
                var check = false;
                message = message + "<li>开始时间不能晚于结束时间!</li>";
            }
            if (check == false) {
                $.prompt("<span style=\" color:#AD6C14\">"+message+"</span>", {
                    title: "提示",
                    buttons: {"确定": false}
                });
                return false;
            } else {
                return true;
            }

        }
    </script>
</block>
